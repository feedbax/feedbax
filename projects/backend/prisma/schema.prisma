generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id       String  @id
  email    String  @unique
  password String
  events   Event[]
}

model Event {
  slug           String     @id
  startDate      DateTime
  durationInDays Int
  settings       Json?
  userId         String?
  user           User?      @relation(fields: [userId], references: [id])
  questions      Question[]

  @@index([userId], name: "userId")
}

model Question {
  id        String       @id
  order     Int
  type      QuestionType @default(NONE)
  text      String
  eventSlug String?
  event     Event?       @relation(fields: [eventSlug], references: [slug])
  answers   Answer[]

  @@index([eventSlug], name: "eventSlug")
}

model Answer {
  id         String    @id
  text       String
  author     String
  created    DateTime
  questionId String?
  question   Question? @relation(fields: [questionId], references: [id])
  likes      Like[]

  @@index([questionId], name: "questionId")
}

model Like {
  id       String  @id
  author   String
  answerId String?
  answer   Answer? @relation(fields: [answerId], references: [id])

  @@unique([answerId, author], name: "answerId_author")
  @@index([answerId], name: "answerId")
}

model Worker {
  id        Int      @id
  keepAlive DateTime
}

enum QuestionType {
  NONE
  POLL
  VOTE
}
